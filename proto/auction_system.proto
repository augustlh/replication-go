syntax = "proto3";

package auction_system;
import "google/protobuf/empty.proto";
import "google/protobuf/timestamp.proto";

option go_package = "auction_system/proto;auction_system";

service AuctionService {
  rpc RegisterBidder (RegisterBidderReq)     returns (RegisterBidderResp);
  rpc PlaceBid       (PlaceBidReq)           returns (PlaceBidResp);
  rpc GetStatus      (google.protobuf.Empty) returns (GetStatusResp);
}

service NodeService {
  rpc Heartbeat        (PingRequest) returns (google.protobuf.Empty);
  rpc ReplicateRequest (PlaceBidReq) returns (google.protobuf.Empty);
}
message PingRequest {
  int64 from_id = 1;
}

message RegisterBidderReq {
  string bidder_id = 1;
}

message RegisterBidderResp {
  bool ok = 1;
  string message = 2;
}

message PlaceBidReq {
  string bidder_id = 1;
  int64 amount = 2;
}

message PlaceBidResp {
  bool accepted = 1;
  string reason = 2;
}

message GetStatusResp {
  bool closed = 1;
  int64 highest_bid = 2;
  string highest_bidder = 3;
  repeated string registered_bidders = 4;
  google.protobuf.Timestamp deadline = 5;
}
